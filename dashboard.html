<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Leave Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Segoe UI,Arial,sans-serif;
  background:#f2f5fa;
}
.header{
  background:linear-gradient(135deg,#1e3c72,#2a5298);
  color:white;
  padding:15px 25px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.header b{font-size:16px;}
.logout{
  background:#ff4d4d;
  border:none;
  color:white;
  padding:8px 14px;
  border-radius:6px;
  cursor:pointer;
}
.container{
  padding:20px;
}
.card{
  background:white;
  padding:20px;
  border-radius:14px;
  box-shadow:0 8px 20px rgba(0,0,0,.1);
}
.grid{
  margin-top:15px;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:15px;
}
.box{
  background:#f0f4ff;
  padding:15px;
  border-radius:12px;
  text-align:center;
}
.box h3{
  margin:0;
  font-size:14px;
  color:#444;
}
.box p{
  margin:8px 0 0;
  font-size:22px;
  font-weight:bold;
  color:#1e3c72;
}
.footer{
  text-align:center;
  font-size:12px;
  color:#999;
  margin-top:20px;
}
</style>
</head>
<body>

<div class="header">
  <b id="userInfo">Loading...</b>
  <button class="logout" onclick="logout()">Logout</button>
</div>

<div class="container">
  <div class="card">
    <h2>Annual Leave Summary</h2>
    <div class="grid" id="leaveBox"></div>
  </div>

  <div class="footer">
    Leave Management System Â© 2026
  </div>
</div>

<script>
const API_URL="https://script.google.com/macros/s/AKfycbw5M-jseprlgAy34MB7zYXdit97EdbmSfakjhfqEeIR-E-m768YBV5DPznWiXMkwkp5Zw/exec";
const id=sessionStorage.getItem("privyId");

if(!id){
  window.location="index.html"; // login page
}

fetch(`${API_URL}?mode=leave&id=${id}`)
.then(r=>r.json())
.then(d=>{
  if(d.status!="ok"){
    logout();
  }

  document.getElementById("userInfo").innerText =
    d.name+" | "+d.position;

  const data = [
    ["Annual Leave", d.annual],
    ["Bonus Leave", d.bonus],
    ["Total Leave", d.total],
    ["Leave Taken", d.taken],
    ["Year-End Balance", d.yearEnd],
    ["Available Leave", d.available]
  ];

  let html="";
  data.forEach(i=>{
    html+=`
      <div class="box">
        <h3>${i[0]}</h3>
        <p>${i[1]} Days</p>
      </div>
    `;
  });

  document.getElementById("leaveBox").innerHTML=html;
});

function logout(){
  sessionStorage.clear();
  window.location="index.html";
}
</script>

</body>
</html>
